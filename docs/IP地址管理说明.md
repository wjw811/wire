# 🌐 IP地址管理说明

## 💡 为什么IP会变化？

### 动态IP (DHCP) - 您之前使用的

**工作原理：**
```
每次连接WiFi：
  1. 电脑向路由器请求IP
  2. 路由器从IP池中分配一个可用IP
  3. 电脑使用分配的IP

下次连接：
  1. 可能分配到不同的IP（如果之前的IP被其他设备占用）
  2. 或者分配到相同的IP（如果还空闲）
```

**变化时机：**
- ❌ **不是每天更新**
- ✅ 断开WiFi再连接时可能变
- ✅ 路由器重启后可能变
- ✅ 电脑重启后可能变
- ✅ DHCP租约到期后可能变（通常24小时）

**您的情况：**
```
前几天: 192.168.2.84  ← WiFi模块配置连接这个
今天:   192.168.2.94  ← 路由器分配了新IP
结果:   WiFi模块连接 .84，但电脑是 .94 → 连接失败！
```

---

## ✅ 解决方案：静态IP

### 什么是静态IP？

**手动固定IP地址，永远不变！**

```
电脑配置: 我的IP固定为 192.168.2.94
路由器: 好的，这个IP保留给你，其他设备不能用

以后无论何时：
  - 重启电脑 → IP还是 192.168.2.94
  - 断开WiFi再连 → IP还是 192.168.2.94  
  - 路由器重启 → IP还是 192.168.2.94
```

---

## 🔧 已为您准备好的脚本

### 1. 设置静态IP

**文件：** `scripts\设置静态IP.bat`

**配置：**
```
IP地址: 192.168.2.94  ← 您当前的IP
子网掩码: 255.255.255.0
网关: 192.168.2.1
DNS: 192.168.2.1, 8.8.8.8
```

**使用：**
1. 右键点击 `设置静态IP.bat`
2. 选择"以管理员身份运行"
3. 按 Y 确认
4. 完成！

---

### 2. 启动脚本增强

**文件：** `scripts\start_all.ps1`

**新增功能：**
- ✅ 启动时自动检查IP是否为 192.168.2.94
- ✅ 检查网关是否连接到 pomo.exe
- ✅ 如果IP不对，提示设置静态IP
- ✅ 显示详细的访问地址和状态

---

## 📊 静态IP vs 动态IP对比

| 特性 | 动态IP (DHCP) | 静态IP |
|------|---------------|--------|
| **IP是否变化** | ✅ 经常变 | ❌ 永远不变 |
| **配置难度** | 简单（自动） | 需要手动配置一次 |
| **适合场景** | 普通上网 | 服务器、固定连接 |
| **您的情况** | ❌ WiFi模块连不上 | ✅ 完美解决 |
| **互联网访问** | ✅ 正常 | ✅ 正常 |
| **切换网络** | ✅ 自动适应 | ⚠️ 需要改回动态 |

---

## 🎯 针对您的情况

### 问题：
- WiFi模块配置连接 `192.168.2.94:2024`
- 但您的电脑IP可能变成 `.95`, `.96`, `.100` 等
- 每次变化，WiFi模块都连不上

### 解决：
- 设置静态IP为 `192.168.2.94`
- 以后IP永远是 `.94`
- WiFi模块可以一直连接
- **配置一次，永久有效**

---

## 🔄 如果将来不想用静态IP？

**改回动态IP很简单：**

### 方法 1：使用GUI
1. 打开"设置" → "网络和Internet"
2. 点击"WiFi" → "更改适配器选项"
3. 右键"WLAN" → "属性"
4. 选择"Internet 协议版本 4 (TCP/IPv4)"
5. 选择"自动获取IP地址"
6. 确定

### 方法 2：使用命令
```powershell
# 以管理员运行
Set-NetIPInterface -InterfaceAlias "WLAN" -Dhcp Enabled
```

---

## 💡 动态IP的好处

**为什么路由器默认用动态IP？**

1. **管理方便**
   - 路由器自动分配
   - 避免IP冲突
   - 设备即插即用

2. **资源优化**
   - IP地址有限（如 192.168.2.1 ~ 192.168.2.254）
   - 动态分配可以重复利用
   - 离线设备的IP可以给其他设备用

3. **适合家庭网络**
   - 手机、平板、电脑经常连接断开
   - 不需要固定IP
   - 自动管理更方便

---

## 🎯 什么时候需要静态IP？

**典型场景：**

1. **服务器** - 需要固定IP让其他设备连接
2. **打印机** - 固定IP方便添加
3. **NAS存储** - 固定IP方便访问
4. **监控摄像头** - 固定IP方便管理
5. **您的情况** - WiFi模块需要连接到固定IP

---

## ✨ 最佳实践建议

**对于您的工作电脑：**

### 方案 1：路由器DHCP保留（最佳）
在路由器中设置"DHCP地址保留"：
- 绑定电脑MAC地址到 192.168.2.94
- 电脑仍用DHCP，但总是分配 .94
- 既自动又固定！

### 方案 2：电脑静态IP（简单）
使用我创建的脚本设置静态IP
- 配置简单
- 立即生效
- 切换网络时需要改回动态

### 方案 3：WiFi模块动态目标（灵活）
让WiFi模块支持动态查找服务器
- 需要修改WiFi模块配置
- 或使用域名而非IP

---

## 🎯 我的建议

**对于您当前的情况：**

**使用静态IP 192.168.2.94！**

**理由：**
1. ✅ 最简单，一次配置永久有效
2. ✅ 不影响正常上网
3. ✅ WiFi模块能稳定连接
4. ✅ 系统可靠运行
5. ✅ 需要时可以随时改回动态

---

## 📝 操作清单

现在您需要：

- [ ] 运行 `设置静态IP.bat`（管理员权限）
- [ ] 将电脑IP固定为 192.168.2.94
- [ ] 重启WiFi模块（让它重新连接）
- [ ] 等待1-2分钟
- [ ] 刷新浏览器页面
- [ ] 查看数据是否出现

---

**准备好设置静态IP了吗？** 🚀






