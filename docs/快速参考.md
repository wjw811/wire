# è®¾å¤‡ç›‘æ§ç³»ç»Ÿ - å¿«é€Ÿå‚è€ƒ

## ğŸš€ å¿«é€Ÿå¯åŠ¨

```powershell
# ä¸€é”®å¯åŠ¨ç›´è¿æ¨¡å¼
.\scripts\setup_direct_connection.ps1

# æˆ–åˆ†æ­¥æ‰§è¡Œ
.\scripts\start_multi_bridge.ps1        # å¯åŠ¨æ¡¥æ¥
```

```
æµè§ˆå™¨è®¿é—®: http://127.0.0.1:8000/static/admin
```

---

## ğŸ“ å¸¸ç”¨å‘½ä»¤

### æ¡¥æ¥ç®¡ç†

```powershell
# å¯åŠ¨æ¡¥æ¥
.\scripts\start_multi_bridge.ps1

# åœæ­¢æ¡¥æ¥
.\scripts\stop_bridge.ps1

# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
Get-Process | Select-String "python"
netstat -ano | findstr "18900"
```

### é…ç½®ç”Ÿæˆ

```powershell
# ä»æ•°æ®åº“ç”Ÿæˆé…ç½®
php scripts/generate_device_config.php

# æŸ¥çœ‹ç”Ÿæˆçš„é…ç½®
cat config/devices.json
cat static/admin/device-config.json
```

### æ•°æ®åº“æ“ä½œ

```sql
-- æ·»åŠ  local_ip å­—æ®µï¼ˆä»…é¦–æ¬¡ï¼‰
SOURCE scripts/add_local_ip_field.sql;

-- æŸ¥çœ‹ç½‘å…³é…ç½®
SELECT id, name, serial, local_ip FROM b_gateway;

-- æ›´æ–°ç½‘å…³IP
UPDATE b_gateway SET local_ip = '192.168.2.10' WHERE id = 1;
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¿«é€Ÿè¯Šæ–­

```powershell
# 1. æµ‹è¯•è®¾å¤‡è¿é€šæ€§
ping 192.168.2.10
Test-NetConnection 192.168.2.10 -Port 18899

# 2. æ£€æŸ¥æ¡¥æ¥è¿›ç¨‹
Get-Process | Select-String "python"

# 3. æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -ano | findstr "18900"

# 4. æŸ¥çœ‹é…ç½®æ–‡ä»¶
cat config/devices.json
```

### æµè§ˆå™¨æ§åˆ¶å°

```
æŒ‰ F12 â†’ Console æŸ¥çœ‹:
âœ… [Auto Query] âœ… Connected
âœ… [Auto Query] Command sent
âœ… Parsing CK mode data...
âœ… [Auto Query] Data updated
```

---

## ğŸ“‚ é‡è¦æ–‡ä»¶

```
é…ç½®æ–‡ä»¶:
â”œâ”€ config/devices.json              # æ¡¥æ¥é…ç½®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€ static/admin/device-config.json  # å‰ç«¯é…ç½®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â””â”€ static/admin/auto-fix.js         # è‡ªåŠ¨è¿æ¥è„šæœ¬

è„šæœ¬æ–‡ä»¶:
â”œâ”€ scripts/setup_direct_connection.ps1   # ä¸€é”®é…ç½®
â”œâ”€ scripts/generate_device_config.php    # ç”Ÿæˆé…ç½®
â”œâ”€ scripts/start_multi_bridge.ps1        # å¯åŠ¨æ¡¥æ¥
â”œâ”€ scripts/stop_bridge.ps1               # åœæ­¢æ¡¥æ¥
â””â”€ scripts/add_local_ip_field.sql        # æ•°æ®åº“è¿ç§»
```

---

## ğŸ”§ é…ç½®è¦ç‚¹

### WiFi æ¨¡å—é…ç½®

```
Socket A: TCP Client â†’ 10.10.100.100:2024  (æœåŠ¡å™¨æ¨¡å¼)
Socket B: TCP Server â†’ Port 18899          (ç›´è¿æ¨¡å¼) â­
```

### ç½‘å…³é…ç½®

```
åå°ç®¡ç† â†’ è®¾å¤‡ç®¡ç† â†’ ç½‘å…³åˆ—è¡¨ â†’ ç¼–è¾‘
å¡«å†™"å±€åŸŸç½‘IP": 192.168.2.10
```

### æ¡¥æ¥ç«¯å£åˆ†é…

```
è®¾å¤‡1 â†’ ws://127.0.0.1:18900 â†’ 192.168.2.10:18899
è®¾å¤‡2 â†’ ws://127.0.0.1:18901 â†’ 192.168.2.10:18899
è®¾å¤‡3 â†’ ws://127.0.0.1:18902 â†’ 192.168.2.11:18899
```

---

## ğŸ“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ·»åŠ æ–°è®¾å¤‡ï¼Ÿ
```
A: åå°æ·»åŠ ç½‘å…³å¹¶å¡«å†™IP â†’ php scripts/generate_device_config.php â†’ é‡å¯æ¡¥æ¥
```

### Q: æ•°æ®ä¸åˆ·æ–°ï¼Ÿ
```
A: F12æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ â†’ æ£€æŸ¥æ¡¥æ¥æœåŠ¡ â†’ æµ‹è¯•è®¾å¤‡è¿é€šæ€§
```

### Q: ç«¯å£è¢«å ç”¨ï¼Ÿ
```
A: ä¿®æ”¹ config/devices.json ä¸­çš„ bridgePort â†’ é‡å¯æ¡¥æ¥
```

### Q: å¦‚ä½•è¿œç¨‹è®¿é—®ï¼Ÿ
```
A: ç›´è¿æ¨¡å¼ä»…æ”¯æŒå±€åŸŸç½‘ï¼Œè¿œç¨‹è®¿é—®è¯·ä½¿ç”¨æœåŠ¡å™¨æ¨¡å¼æˆ–VPN
```

---

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
æµè§ˆå™¨ â†â”€ WebSocket â”€â†’ æœ¬åœ°æ¡¥æ¥ â†â”€ TCP â”€â†’ WiFiæ¨¡å— â†â”€ ä¸²å£ â”€â†’ è®¾å¤‡
(auto-fix.js)      (websockify)       (Socket B)         (æ•°æ®)
   â†‘                     â†‘
   |                     |
device-config.json   devices.json
   â†‘                     â†‘
   â””â”€â”€â”€â”€â”€ è‡ªåŠ¨ç”Ÿæˆ â†â”€â”€â”€â”€â”€â”˜
          (PHPè„šæœ¬)
              â†‘
        MySQLæ•°æ®åº“
    (b_gateway.local_ip)
```

---

## âš¡ æ€§èƒ½å‚æ•°

```
åˆ·æ–°é¢‘ç‡: 3ç§’/æ¬¡
ç½‘ç»œå»¶è¿Ÿ: <20ms (å±€åŸŸç½‘)
CPUå ç”¨: <1% (æ¯ä¸ªæ¡¥æ¥)
å†…å­˜å ç”¨: ~10MB (æ¯ä¸ªæ¡¥æ¥)
```

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- ğŸ“– `å®¢æˆ·éƒ¨ç½²æŒ‡å—.md` - å®Œæ•´éƒ¨ç½²æ­¥éª¤
- ğŸ“– `ç›´è¿æ¨¡å¼å®Œæ•´æ–¹æ¡ˆ.md` - æŠ€æœ¯æ–¹æ¡ˆè¯¦è§£
- ğŸ“– `WiFi232_B2_é…ç½®æŒ‡å—.md` - æ¨¡å—é…ç½®
- ğŸ“– `è®¾å¤‡ç›´è¿é€šä¿¡æŒ‡å—.md` - é€šä¿¡åè®®

---

**å¿«é€Ÿå‚è€ƒå®Œæˆï¼ä¿å­˜æ­¤æ–‡ä»¶ä»¥ä¾¿éšæ—¶æŸ¥é˜…ã€‚** ğŸ“Œ





























