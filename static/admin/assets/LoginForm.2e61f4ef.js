var R=(C,i,m)=>new Promise((r,x)=>{var t=o=>{try{g(m.next(o))}catch(p){x(p)}},w=o=>{try{g(m.throw(o))}catch(p){x(p)}},g=o=>o.done?r(o.value):Promise.resolve(o.value).then(t,w);g((m=m.apply(C,i)).next())});import{d as M,k as S,r as A,e as G,u as e,$ as N,a0 as O,t as $,A as T,f as s,a8 as a,E as d,a2 as u,a1 as P,a3 as U,ah as V,F as j}from"./vue.5d40fadb.js";import{b as q,a as K,f as W,h as Q}from"./index.a544321c.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               */import{u as Y,a as H,b as J,L as c,_ as X}from"./LoginFormTitle.389d220c.js";import{ad as L,Y as h,ae as Z,a8 as f,af as ee,ag as se,ah as ae,ai as le,aj as te,ak as oe,al as ne,am as ie}from"./ui.83c3e48a.js";import"./utils.79519c03.js";const xe=M({__name:"LoginForm",setup(C){const i=ne,m=ie,r=L.Item,x=h.Password,{t}=q(),{notification:w,createErrorModal:g}=Q(),{prefixCls:o}=K("login"),p=W(),{setLoginState:y,getLoginState:B}=Y(),{getFormRules:D}=H(),F=S(),_=S(!1),b=S(!1),v=A({code:"",pwd:""}),{validForm:z}=J(F),E=G(()=>e(B)===c.LOGIN);function I(){return R(this,null,function*(){const k=yield z();if(!!k)try{_.value=!0;const l=yield p.login({pwd:k.pwd,code:k.code,mode:"none"});l&&w.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${l.name}`,duration:3})}catch(l){g({title:t("sys.api.errorTip"),content:l.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${o}`)||document.body})}finally{_.value=!1}})}return(k,l)=>(N(),O(j,null,[$(s(X,{class:"enter-x"},null,512),[[T,E.value]]),$(s(e(L),{class:"p-4 enter-x",model:v,rules:e(D),ref_key:"formRef",ref:F,onKeypress:V(I,["enter"])},{default:a(()=>[s(e(r),{name:"code",class:"enter-x"},{default:a(()=>[s(e(h),{size:"large",value:v.code,"onUpdate:value":l[0]||(l[0]=n=>v.code=n),placeholder:e(t)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(r),{name:"pwd",class:"enter-x"},{default:a(()=>[s(e(x),{size:"large",visibilityToggle:"",value:v.pwd,"onUpdate:value":l[1]||(l[1]=n=>v.pwd=n),placeholder:e(t)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(m),{class:"enter-x"},{default:a(()=>[s(e(i),{span:12},{default:a(()=>[s(e(r),null,{default:a(()=>[s(e(Z),{checked:b.value,"onUpdate:checked":l[2]||(l[2]=n=>b.value=n),size:"small"},{default:a(()=>[d(u(e(t)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(i),{span:12,class:"display-none"},{default:a(()=>[s(e(r),{style:{"text-align":"right"}},{default:a(()=>[s(e(f),{type:"link",size:"small",onClick:l[3]||(l[3]=n=>e(y)(e(c).REGISTER))},{default:a(()=>[d(u(e(t)("sys.login.registerButton")),1)]),_:1})]),_:1})]),_:1}),s(e(i),{span:12,class:"display-none"},{default:a(()=>[s(e(r),{style:{"text-align":"right"}},{default:a(()=>[s(e(f),{type:"link",size:"small",onClick:l[4]||(l[4]=n=>e(y)(e(c).RESET_PASSWORD))},{default:a(()=>[d(u(e(t)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(r),{class:"enter-x"},{default:a(()=>[s(e(f),{type:"primary",size:"large",block:"",onClick:I,loading:_.value},{default:a(()=>[d(u(e(t)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1}),s(e(m),{class:"enter-x display-none"},{default:a(()=>[s(e(i),{md:8,xs:24},{default:a(()=>[s(e(f),{block:"",onClick:l[5]||(l[5]=n=>e(y)(e(c).MOBILE))},{default:a(()=>[d(u(e(t)("sys.login.mobileSignInFormTitle")),1)]),_:1})]),_:1}),s(e(i),{md:8,xs:24,class:"!my-2 !md:my-0 xs:mx-0 md:mx-2"},{default:a(()=>[s(e(f),{block:"",onClick:l[6]||(l[6]=n=>e(y)(e(c).QR_CODE))},{default:a(()=>[d(u(e(t)("sys.login.qrSignInFormTitle")),1)]),_:1})]),_:1}),s(e(i),{md:6,xs:24},{default:a(()=>[s(e(f),{block:"",onClick:l[7]||(l[7]=n=>e(y)(e(c).REGISTER))},{default:a(()=>[d(u(e(t)("sys.login.registerButton")),1)]),_:1})]),_:1})]),_:1}),s(e(ee),{class:"enter-x display-none"},{default:a(()=>[d(u(e(t)("sys.login.otherSignIn")),1)]),_:1}),P("div",{class:U(["flex justify-evenly enter-x display-none",`${e(o)}-sign-in-way`])},[s(e(se)),s(e(ae)),s(e(le)),s(e(te)),s(e(oe))],2)]),_:1},8,["model","rules"]),[[T,E.value]])],64))}});export{xe as default};
