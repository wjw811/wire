var b=(y,v,e)=>new Promise((g,c)=>{var u=r=>{try{o(e.next(r))}catch(s){c(s)}},t=r=>{try{o(e.throw(r))}catch(s){c(s)}},o=r=>r.done?g(r.value):Promise.resolve(r.value).then(u,t);o((e=e.apply(y,v)).next())});import{b as w,h as C}from"./index.f8dcff9b.js";/* empty css              */import{b as I,B as P}from"./index.3d9df1da.js";import{u as L,B as S}from"./useTable.0365df15.js";import"./useForm.8bc02932.js";import{s as N,b as V}from"./role.6ef24215.js";import{be as E,ae as $}from"./ui.3c499a62.js";import{d as A,k as _,r as D,e as F,u as i,a1 as d,a7 as h,a9 as f,f as U,a2 as G,F as O,ad as j,E as q,a4 as z,V as H,a8 as J}from"./vue.2e68d871.js";import"./utils.b124f726.js";import"./table.68230543.js";import"./useWindowSizeFn.7b554b6f.js";/* empty css               */import"./index.c762d615.js";/* empty css                *//* empty css                */import"./useContentViewHeight.31b45b6e.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               */import"./sortable.esm.e8ee5a53.js";/* empty css               *//* empty css               *//* empty css               */import"./index.8e12a0dc.js";import"./download.1a473a50.js";import"./index.e09f6ddc.js";const xe=A({__name:"PrivilegeModal",emits:["success","register"],setup(y,{emit:v}){const{t:e}=w(),g=[{title:e("system.role.priv.code"),dataIndex:"code",width:150},{title:e("system.role.priv.mode"),dataIndex:"name",width:200},{title:e("system.role.priv.name"),dataIndex:"privilege"}],c=v,u=_(""),t=D({data:[],role:""}),o=_(null),[r,{setModalProps:s,closeModal:k}]=I(a=>b(this,null,function*(){var n,l;s({confirmLoading:!1,width:1e3}),t.data=[],t.role=(n=a==null?void 0:a.record)==null?void 0:n.code,u.value=(l=a==null?void 0:a.record)==null?void 0:l.name,M({searchInfo:{role:t.role}}),B()})),[x,{setProps:M,reload:B}]=L({api:V,columns:g,bordered:!1,immediate:!1,showTableSetting:!1,pagination:!1}),R=F(()=>`${e("system.role.priv.set")} - [ ${i(u)} ]`);function T(){return b(this,null,function*(){try{if(s({confirmLoading:!0}),o.value){o.value.getDataSource().forEach(l=>{const{have:m}=l;t.data=[...t.data,...m]}),yield N(t);const{createMessage:n}=C();n.success(e("system.role.priv.setSuccess")),k(),c("success",{values:t})}}finally{s({confirmLoading:!1})}})}return(a,n)=>(d(),h(i(P),J(a.$attrs,{onRegister:i(r),title:R.value,onOk:T}),{default:f(()=>[U(i(S),{onRegister:i(x),ref_key:"tableRef",ref:o},{bodyCell:f(({column:l,record:m})=>[l.key==="privilege"?(d(),h(i(E),{key:0,value:m.have,"onUpdate:value":p=>m.have=p},{default:f(()=>[(d(!0),G(O,null,j(m.privilege,p=>(d(),h(i($),{key:p.id,value:p.id},{default:f(()=>[q(z(p.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value"])):H("",!0)]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{xe as default};
