var ue=Object.defineProperty,de=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var V=(c,t,n)=>t in c?ue(c,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):c[t]=n,O=(c,t)=>{for(var n in t||(t={}))ce.call(t,n)&&V(c,n,t[n]);if(R)for(var n of R(t))pe.call(t,n)&&V(c,n,t[n]);return c},j=(c,t)=>de(c,re(t));var q=(c,t,n)=>new Promise((p,E)=>{var S=r=>{try{_(n.next(r))}catch(y){E(y)}},f=r=>{try{_(n.throw(r))}catch(y){E(y)}},_=r=>r.done?p(r.value):Promise.resolve(r.value).then(S,f);_((n=n.apply(c,t)).next())});import{u as me,B as fe}from"./useTable.0365df15.js";import{T as _e}from"./useForm.8bc02932.js";import{g as H,d as ve,a as ge,u as ye}from"./gateway.68a1dc2f.js";import{a as be}from"./index.c762d615.js";import{u as we}from"./index.3d9df1da.js";import{_ as he,b as Ce,r as Fe,h as ke}from"./index.f8dcff9b.js";import{c as Ee,s as Se,_ as De}from"./form.d8739d42.js";import{d as Be,r as ze,k as h,o as xe,U as b,a1 as w,a7 as L,a9 as u,a3 as s,a2 as k,F as W,ad as J,f as i,E as g,a4 as d,u as l,V as K,a5 as Ae}from"./vue.2e68d871.js";/* empty css               *//* empty css              */import"./ui.3c499a62.js";/* empty css               *//* empty css               *//* empty css               */import"./utils.b124f726.js";import"./useWindowSizeFn.7b554b6f.js";/* empty css               */import"./sortable.esm.e8ee5a53.js";/* empty css               *//* empty css               *//* empty css               */import"./index.8e12a0dc.js";import"./download.1a473a50.js";import"./index.e09f6ddc.js";/* empty css                *//* empty css                */import"./useContentViewHeight.31b45b6e.js";import"./table.68230543.js";import"./data.1ea74f5c.js";import"./fireware.93a0722c.js";const Te={class:"new-cards"},Ue={class:"new-card-header"},Me={class:"new-card-body"},$e={class:"row"},Ie={class:"value"},Ne={class:"row"},Pe={class:"value"},Re={class:"row"},Ve={class:"value"},Oe={class:"mobile-card-list"},je={class:"card-list-header"},qe={class:"search-form"},He={class:"form-buttons"},Le={class:"debug-info",style:{background:"#f0f0f0",padding:"10px",margin:"10px 0","border-radius":"4px"}},We={key:0,class:"card-list"},Je={class:"card-header"},Ke={class:"card-content"},Ge={class:"info-row"},Qe={class:"value"},Xe={class:"info-row"},Ye={class:"value"},Ze={class:"info-row"},es={class:"value"},ss={class:"info-row"},ts={class:"value"},as={class:"info-row"},ls={class:"value"},os={class:"card-actions"},ns={class:"pagination-wrapper"},is=Be({__name:"index",setup(c){const{t}=Ce(),{createMessage:n}=ke(),{hasPermission:p}=Fe(),[E,{openModal:S}]=we(),f=ze({}),_=h([]),r=h(1),y=h(10),C=h(0),x=h(!1),A=h([]),[G,{reload:T,getDataSource:Q,getPaginationInfo:F,setTableData:X,setPagination:Y}]=me({title:" ",api:H,rowKey:"id",columns:Ee,formConfig:{labelWidth:80,schemas:Se,autoSubmitOnEnter:!0},useSearchForm:!0,showTableSetting:!0,bordered:!0,actionColumn:{width:150,title:t("sys.util.action"),dataIndex:"action"}});function B(){return q(this,null,function*(){try{x.value=!0;const o=yield H(j(O({},f),{page:r.value,pageSize:y.value})),e=o.items||o.list||o.data||[];_.value=e,C.value=o.total||e.length||0;try{X(e),Y({total:C.value,current:r.value,pageSize:y.value})}catch(v){}}catch(o){}finally{x.value=!1}})}function U(){const o=Q(),e=typeof F=="function"?F():F==null?void 0:F.value;Array.isArray(o)&&o.length>0&&(_.value=o),C.value=(e==null?void 0:e.total)||0,r.value=(e==null?void 0:e.current)||1,y.value=(e==null?void 0:e.pageSize)||10}function Z(){B()}function ee(){Object.keys(f).forEach(o=>{f[o]=void 0}),r.value=1,B()}xe(()=>{B(),setTimeout(U,1e3)});function M(){S(!0,{isUpdate:!1})}function $(o){S(!0,{record:o,isUpdate:!0})}function I(o){ve(o).then(()=>{n.success(t("sys.util.deleteSuccess"))}).finally(()=>{T()})}function N(o){ge(o).then(()=>{n.success(t("sys.util.cmdSuccess"))})}function P(o){ye(o).then(()=>{n.success(t("sys.util.cmdSuccess"))})}function se(){T(),setTimeout(U,100)}function te(o){A.value.splice(o,1)}return(o,e)=>{const v=b("a-button"),ae=b("a-input"),z=b("a-form-item"),le=b("a-select-option"),oe=b("a-select"),ne=b("a-form"),ie=b("a-pagination");return w(),L(l(be),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex"},{default:u(()=>[s("div",Te,[(w(!0),k(W,null,J(A.value,(a,m)=>(w(),k("div",{key:a.__key||m,class:"new-gateway-card"},[s("div",Ue,[e[5]||(e[5]=s("strong",null,"\u65B0\u7F51\u5173\u5DF2\u6DFB\u52A0",-1)),i(v,{size:"small",onClick:D=>te(m)},{default:u(()=>[...e[4]||(e[4]=[g("\u5173\u95ED",-1)])]),_:1},8,["onClick"])]),s("div",Me,[s("div",$e,[e[6]||(e[6]=s("span",{class:"label"},"\u540D\u79F0",-1)),s("span",Ie,d(a.name||"-"),1)]),s("div",Ne,[e[7]||(e[7]=s("span",{class:"label"},"\u5E8F\u5217\u53F7",-1)),s("span",Pe,d(a.serial||"-"),1)]),s("div",Re,[e[8]||(e[8]=s("span",{class:"label"},"\u5B89\u88C5\u5730\u70B9",-1)),s("span",Ve,d(a.addr||"-"),1)])])]))),128))]),i(l(fe),{onRegister:l(G),class:"w-full desktop-table",searchInfo:f},{toolbar:u(()=>[i(v,{type:"primary",onClick:M,disabled:!l(p)(["disc","add"])},{default:u(()=>[g(d(l(t)("sys.util.add")),1)]),_:1},8,["disabled"])]),bodyCell:u(({column:a,record:m})=>[a.key==="action"?(w(),L(l(_e),{key:0,actions:[{tooltip:l(t)("sys.util.edit"),icon:"clarity:note-edit-line",color:"#1890ff",disabled:!l(p)(["gateway","edit"]),onClick:$.bind(null,m)},{icon:"ant-design:delete-outlined",color:"#ff4d4f",tooltip:l(t)("sys.util.delete"),disabled:!l(p)(["gateway","del"]),popConfirm:{title:l(t)("sys.util.confirm"),placement:"left",confirm:I.bind(null,m)}},{icon:"ant-design:download-outlined",color:"#8c8c8c",tooltip:l(t)("dev.gateway.fwDown"),disabled:!l(p)(["gateway","edit"])||!m.fid,onClick:N.bind(null,m)},{icon:"ant-design:thunderbolt-outlined",color:"#8c8c8c",tooltip:l(t)("dev.gateway.fwUpgrade"),disabled:!l(p)(["gateway","edit"])||!m.fid,popConfirm:{title:l(t)("sys.util.confirmUpgrade"),placement:"left",confirm:P.bind(null,m)}}]},null,8,["actions"])):K("",!0)]),_:1},8,["onRegister","searchInfo"]),s("div",Oe,[s("div",je,[i(v,{type:"primary",onClick:M,disabled:!l(p)(["disc","add"])},{default:u(()=>[g(d(l(t)("sys.util.add")),1)]),_:1},8,["disabled"])]),s("div",qe,[i(ne,{layout:"vertical",model:f},{default:u(()=>[i(z,{label:l(t)("dev.gateway.name")},{default:u(()=>[i(ae,{value:f.name,"onUpdate:value":e[0]||(e[0]=a=>f.name=a),placeholder:l(t)("sys.util.pleaseEnter")},null,8,["value","placeholder"])]),_:1},8,["label"]),i(z,{label:l(t)("dev.gateway.fireware")},{default:u(()=>[i(oe,{value:f.fireware,"onUpdate:value":e[1]||(e[1]=a=>f.fireware=a),placeholder:l(t)("sys.util.pleaseSelect")},{default:u(()=>[i(le,{value:""},{default:u(()=>[...e[9]||(e[9]=[g("\u5168\u90E8",-1)])]),_:1})]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),i(z,null,{default:u(()=>[s("div",He,[i(v,{onClick:ee},{default:u(()=>[g(d(l(t)("sys.util.reset")),1)]),_:1}),i(v,{type:"primary",onClick:Z},{default:u(()=>[g(d(l(t)("sys.util.query")),1)]),_:1})])]),_:1})]),_:1},8,["model"])]),s("div",Le,[s("p",null,"\u6570\u636E\u6E90\u957F\u5EA6: "+d(_.value.length),1),s("p",null,"\u603B\u6570: "+d(C.value),1),s("p",null,"\u5F53\u524D\u9875: "+d(r.value),1),s("p",null,"\u6570\u636E: "+d(JSON.stringify(_.value.slice(0,2))),1)]),_.value.length>0?(w(),k("div",We,[(w(!0),k(W,null,J(_.value,a=>{var m;return w(),k("div",{class:"gateway-card",key:a.id},[s("div",Je,[s("h3",null,d(a.name),1),s("span",{class:Ae(["status",a.state===1?"online":"offline"])},d(a.state===1?"\u5728\u7EBF":"\u79BB\u7EBF"),3)]),s("div",Ke,[s("div",Ge,[e[10]||(e[10]=s("span",{class:"label"},"\u5E8F\u5217\u53F7:",-1)),s("span",Qe,d(a.serial),1)]),s("div",Xe,[e[11]||(e[11]=s("span",{class:"label"},"\u5C40\u57DF\u7F51IP:",-1)),s("span",Ye,d(a.local_ip||"-"),1)]),s("div",Ze,[e[12]||(e[12]=s("span",{class:"label"},"\u5B89\u88C5\u5730\u70B9:",-1)),s("span",es,d(a.addr||"-"),1)]),s("div",ss,[e[13]||(e[13]=s("span",{class:"label"},"\u6302\u8F7D\u8BBE\u5907:",-1)),s("span",ts,d(((m=a.dev)==null?void 0:m.length)||0)+" \u4E2A",1)]),s("div",as,[e[14]||(e[14]=s("span",{class:"label"},"\u56FA\u4EF6:",-1)),s("span",ls,d(a.fireware||"-"),1)])]),s("div",os,[i(v,{size:"small",onClick:D=>$(a),disabled:!l(p)(["gateway","edit"])},{default:u(()=>[...e[15]||(e[15]=[g(" \u7F16\u8F91 ",-1)])]),_:1},8,["onClick","disabled"]),i(v,{size:"small",danger:"",onClick:D=>I(a),disabled:!l(p)(["gateway","del"])},{default:u(()=>[...e[16]||(e[16]=[g(" \u5220\u9664 ",-1)])]),_:1},8,["onClick","disabled"]),i(v,{size:"small",onClick:D=>N(a),disabled:!l(p)(["gateway","edit"])||!a.fid},{default:u(()=>[...e[17]||(e[17]=[g(" \u4E0B\u8F7D ",-1)])]),_:1},8,["onClick","disabled"]),i(v,{size:"small",onClick:D=>P(a),disabled:!l(p)(["gateway","edit"])||!a.fid},{default:u(()=>[...e[18]||(e[18]=[g(" \u5347\u7EA7 ",-1)])]),_:1},8,["onClick","disabled"])])])}),128))])):K("",!0),s("div",ns,[i(ie,{current:r.value,"onUpdate:current":e[2]||(e[2]=a=>r.value=a),pageSize:y.value,"onUpdate:pageSize":e[3]||(e[3]=a=>y.value=a),total:C.value,"show-size-changer":!1,"show-quick-jumper":!1,size:"small"},null,8,["current","pageSize","total"])])]),i(De,{onRegister:l(E),onSuccess:se},null,8,["onRegister"])]),_:1})}}});var Rs=he(is,[["__scopeId","data-v-005251ef"]]);export{Rs as default};
