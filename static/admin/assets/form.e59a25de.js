var M=Object.defineProperty,O=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var z=(e,a,t)=>a in e?M(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,m=(e,a)=>{for(var t in a||(a={}))A.call(a,t)&&z(e,t,a[t]);if(P)for(var t of P(a))N.call(a,t)&&z(e,t,a[t]);return e},I=(e,a)=>O(e,T(a));var _=(e,a,t)=>new Promise((v,i)=>{var p=n=>{try{l(t.next(n))}catch(f){i(f)}},b=n=>{try{l(t.throw(n))}catch(f){i(f)}},l=n=>n.done?v(n.value):Promise.resolve(n.value).then(p,b);l((t=t.apply(e,a)).next())});import{b as S,aT as $}from"./index.a544321c.js";import{j,B as q}from"./useForm.ecd151fb.js";import{b as L,B as D}from"./index.4d884b9c.js";import{k as y}from"./data.f933c358.js";import{r as G}from"./utils.79519c03.js";import{e as E,a as K}from"./fireware.6c4a74dd.js";import{b1 as W,a8 as H,bd as J}from"./ui.83c3e48a.js";import{d as Q,k as B,e as X,u as r,$ as Y,a6 as Z,a8 as w,f as h,E as ee,a2 as te,a7 as ae}from"./vue.5d40fadb.js";const{t:o}=S(),me=[{title:o("software.fireware.name"),dataIndex:"name",align:"left",width:200},{title:o("software.fireware.ver"),dataIndex:"ver",width:100},{title:o("software.fireware.size"),dataIndex:"size",width:100,customRender:({record:e})=>`${G(e.size/1024)} KB`},{title:o("software.fireware.checksum"),dataIndex:"checksum",width:120},{title:o("sys.util.status"),dataIndex:"status",width:120,customRender:({record:e})=>{var a;return(a=y.status.find(t=>t.k===e.status))==null?void 0:a.v}}],we=[{field:"name",label:o("software.fireware.name"),component:"Input",colProps:{span:6}},{field:"ver",label:o("software.fireware.ver"),component:"Input",colProps:{span:6}},{field:"status",label:o("sys.util.status"),component:"Select",colProps:{span:4},componentProps:()=>({options:y.status.map(e=>({label:e.v,value:e.k}))})}],se=[{field:"id",label:"ID",component:"Input",show:!1},{field:"name",label:o("software.fireware.name"),component:"Input",required:!0},{field:"file",label:o("software.fireware.file"),component:"Input",required:!0,slot:"s1",ifShow:({model:e})=>!e.id},{field:"ver",label:o("software.fireware.ver"),component:"InputNumber",required:!0,componentProps:()=>({min:1,max:9999,precision:0})},{field:"size",label:"Size",component:"Input",show:!1},{field:"status",label:o("sys.util.status"),component:"RadioGroup",defaultValue:1,componentProps:()=>({options:y.status.map(e=>({label:e.v,value:e.k}))})}],re=Q({__name:"form",emits:["success","register"],setup(e,{emit:a}){const{t}=S(),v=a,i=B(!0),p=B(""),[b,{setFieldsValue:l,resetFields:n,validate:f}]=j({labelWidth:120,baseColProps:{span:24},schemas:se,showActionButtonGroup:!1,actionColOptions:{span:23}}),[C,{setModalProps:g,closeModal:U}]=L(s=>_(this,null,function*(){n(),g({confirmLoading:!1}),i.value=!!(s!=null&&s.isUpdate),r(i)&&(p.value=s.record.id,l(m({},s.record)))})),V=X(()=>r(i)?t("sys.util.edit"):t("sys.util.add"));function F(){return _(this,null,function*(){try{const s=yield f();g({confirmLoading:!0}),r(i)?yield E(I(m({},s),{id:p.value})):yield K(s),U(),v("success",{isUpdate:r(i),values:I(m({},s),{id:p.value})})}finally{g({confirmLoading:!1})}})}function R(s,u){var d;if(s.file.status==="done"){const c=((d=s==null?void 0:s.file)==null?void 0:d.response)||{},k=c.name||"",x=c.url||"";u.size=s.file.size,u.name=s.file.name,u.file=k,u.url=x,l({file:k,url:x})}s.file.status==="removed"&&(u.file="",u.url="",l({file:"",url:""}))}return(s,u)=>(Y(),Z(r(D),ae(s.$attrs,{onRegister:r(C),width:"700px",title:V.value,onOk:F}),{default:w(()=>[h(r(q),{onRegister:r(b)},{s1:w(({model:d})=>[h(r(W),{modelValue:d.url,"onUpdate:modelValue":c=>d.url=c,action:"/admin/common/upload",accept:".hex",name:"file",data:{type:"hex"},headers:{Authorization:`${r($)()}`},maxCount:1,onChange:c=>{R(c,d)}},{default:w(()=>[h(r(H),null,{default:w(()=>[h(r(J)),ee(" "+te(r(t)("software.fireware.upload")),1)]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue","headers","onChange"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]))}});var he=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{re as _,me as c,he as f,we as s};
