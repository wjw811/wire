var b=(y,v,e)=>new Promise((g,p)=>{var u=r=>{try{o(e.next(r))}catch(s){p(s)}},t=r=>{try{o(e.throw(r))}catch(s){p(s)}},o=r=>r.done?g(r.value):Promise.resolve(r.value).then(u,t);o((e=e.apply(y,v)).next())});import{b as w,h as C}from"./index.a544321c.js";/* empty css              */import{b as I,B as P}from"./index.4d884b9c.js";import{u as L,B as S}from"./useTable.8740fd04.js";import"./useForm.ecd151fb.js";import{s as N,b as $}from"./role.34a3b7d0.js";import{be as E,ae as V}from"./ui.83c3e48a.js";import{d as A,k as _,r as D,e as F,u as i,$ as d,a6 as h,a8 as f,f as U,a0 as G,F as O,ad as j,E as q,a2 as z,ab as H,a7 as J}from"./vue.5d40fadb.js";import"./utils.79519c03.js";import"./useWindowSizeFn.1ba172e7.js";/* empty css               */import"./index.297fc3d1.js";/* empty css               *//* empty css                */import"./useContentViewHeight.ece959d0.js";/* empty css                *//* empty css                *//* empty css                *//* empty css               */import"./sortable.esm.045ad385.js";/* empty css                *//* empty css               *//* empty css               */import"./index.fa00f44b.js";import"./download.14b6de08.js";import"./index.03b81760.js";const ke=A({__name:"PrivilegeModal",emits:["success","register"],setup(y,{emit:v}){const{t:e}=w(),g=[{title:e("system.role.priv.code"),dataIndex:"code",width:150},{title:e("system.role.priv.mode"),dataIndex:"name",width:200},{title:e("system.role.priv.name"),dataIndex:"privilege"}],p=v,u=_(""),t=D({data:[],role:""}),o=_(null),[r,{setModalProps:s,closeModal:k}]=I(a=>b(this,null,function*(){var n,l;s({confirmLoading:!1,width:1e3}),t.data=[],t.role=(n=a==null?void 0:a.record)==null?void 0:n.code,u.value=(l=a==null?void 0:a.record)==null?void 0:l.name,M({searchInfo:{role:t.role}}),B()})),[x,{setProps:M,reload:B}]=L({api:$,columns:g,bordered:!1,immediate:!1,showTableSetting:!1,pagination:!1}),R=F(()=>`${e("system.role.priv.set")} - [ ${i(u)} ]`);function T(){return b(this,null,function*(){try{if(s({confirmLoading:!0}),o.value){o.value.getDataSource().forEach(l=>{const{have:m}=l;t.data=[...t.data,...m]}),yield N(t);const{createMessage:n}=C();n.success(e("system.role.priv.setSuccess")),k(),p("success",{values:t})}}finally{s({confirmLoading:!1})}})}return(a,n)=>(d(),h(i(P),J(a.$attrs,{onRegister:i(r),title:R.value,onOk:T}),{default:f(()=>[U(i(S),{onRegister:i(x),ref_key:"tableRef",ref:o},{bodyCell:f(({column:l,record:m})=>[l.key==="privilege"?(d(),h(i(E),{key:0,value:m.have,"onUpdate:value":c=>m.have=c},{default:f(()=>[(d(!0),G(O,null,j(m.privilege,c=>(d(),h(i(V),{key:c.id,value:c.id},{default:f(()=>[q(z(c.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value"])):H("",!0)]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{ke as default};
